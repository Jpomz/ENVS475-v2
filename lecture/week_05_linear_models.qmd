---
title: "Lecture Week 05: linear models"
format: 
  html:
    embed-resources: true
editor: visual
toc: true
toc-depth: 2
number-sections: true
theme:
  light: flatly
  dark: darkly
---

```{r}
#| label: setup
#| include: false

# libraries
library(arm)
library(tidyverse)

# data objects
darwin_maize <- read.csv(here::here("data/darwin_maize.csv"), stringsAsFactors = TRUE)
```

# Overview

# Setup

### Libraries

You may need to install the `arm` package with the following:

`install.packages("arm")`

Remember to only run this once in your console, and to NOT put it into your script.

```{r}
#| eval: false

library(arm)
library(tidyverse)
```

### Data

Download the `darwin_maize.csv` file from D2L and put it into your `data/` folder

```{r}
#| eval: false
darwin_maize <- read.csv("data/darwin_maize.csv",
                stringsAsFactors = TRUE)
```

# Outline

1.  What is a model?

2.  What is a linear model?

3.  Basic linear models (problems 1-3, 5)

4.  Confidence intervals for model coefficients (problem 4)

5.  Linear Model Assumptions

# Lecture

### What is a model?

> "An informative representation of an object, person, or system.

-   Many types of models

    -   Conceptual

    -   Graphical

    -   Mathematical

-   We will be working with statistical models

    -   Mathematical representation of our hypotheses

-   By necessity, models will be simplifications of reality

> "All models are wrong, some are useful"

-   Inference requires models

-   Models link observations to processes

### What is a linear model?

-   What is the equation of a line?

Answer is probably something similar to:

$$\Huge y = a + bx$$

```{r}
x <- seq(from = -10, to = 10, by = 0.1)
line_df <- data.frame(x = x,
                      y = -5 + 2 * x)
ggplot(line_df, aes(x = x, y = y)) + 
  geom_path(color = "#446E9B", linewidth = 2) +
  theme_bw()
```

-   In reality, not every point is exactly on the line, right?
-   Add stochatsicity:

$$\Huge y_i = a + bx + \epsilon_i$$

-    $\epsilon$ is "epsilon", and often represents "error" or "noise"

```{r}
set.seed(23)
obs_df <- line_df |>
  sample_n(50) |>
  rowwise() |> 
  mutate(obs = x + rnorm(1, 0, 2))
  
ggplot(line_df, aes(x = x, y = y)) + 
  geom_path(color = "black", linewidth = 2) +
  geom_point(data = obs_df,
             aes(x = obs, y = y),
             size = 2,
             color = "dodgerblue") +
  theme_bw()
```

### Basic linear models (problems 1-3, 5)

-   First, let's modify our variables in the linear model

-   our intercept was $a$ but we are going to change it to $\beta_0$

    -   "Beta zero"

-   the $b$ will be called $\beta_1$

    -   "beta one"

    -   This is much more flexible as we can have $\beta_2$, $\beta_3$ ... $\beta_n$

-   Linear models have the following components:

$$\Large response = deterministic\; part+stochastic\; part$$

-   Write the model showing how our expected value $E[y_i]$ is a function of:

$$\underbrace{\LARGE E[y_i] = \beta_0 + \beta_1 \times x_i}_{Deterministic}$$

-   With the addition of a stochastic error:

$$\underbrace{\LARGE y_i \sim normal(E[y_i], \sigma)}_{Stochastic}$$

-   Add all together:

$$\LARGE y = \beta_0 + \beta_1 \times x + \epsilon$$

#### Global Intercept model

-   If there are no groups and no continuous predictors, we can fit a model which is calculating the global intercept

-   Here, $x = 0$ so $\beta_1 \times 0 = 0$ so we can simplify it

-   In other words, this is calculating the average value of our response

$$\LARGE E[y_i] = \beta_0$$

-   Let's look at the `darwin_maize` data

```{r}
names(darwin_maize)
head(darwin_maize)
```

-   We are interested in the `height` column as our response.

    -   Later we will look at the `type` for our groups

-   Let's plot the response variable, `height`, in the `darwin_maize` data

```{r}
ggplot(darwin_maize,
       aes(y = height,
           x = 0)) +
  geom_point() +
  theme_bw()
```

-   We can also just plot the mean of this variable

```{r}
ggplot(darwin_maize,
       aes(x = 0, 
           y = height)) +
  stat_summary(fun = mean, 
               geom = "point",
               color = "black",
               shape = 8, 
               size = 6) +
  theme_bw()
```

-   Now let's fit our first linear model using the `lm()` function

    -   When fitting a model, you will use the syntax of:

    -   `response_column ~ predictor_column`

    -   In this case there is no predictor column, so we just use the number `1`

```{r}
dlm0 <- lm(formula = height ~ 1,
           data = darwin_maize)
```

### Confidence intervals for model coefficients (problem 4)

### Linear Model Assumptions

# Summary
